$(function(){$.fn.imagesLoaded=function(i){function e(){i.call(a,t)}function n(){--r<=0&&this.src!==l&&(setTimeout(e),t.off("load error",n))}var t=this.find("img"),r=t.length,a=this,l="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";return r||e(),t.on("load error",n).each(function(){if(this.complete||void 0===this.complete){var i=this.src;this.src=l,this.src=i}}),this};var i=$("#rg-gallery"),e=i.find("div.es-carousel-wrapper"),n=e.find("ul > li"),t=n.length;Gallery=function(){var r=0,a=!1,l=function(){e.show().elastislide({imageW:65,onClick:function(i){if(a)return!1;a=!0,c(i),r=i.index()}}),e.elastislide("setCurrent",r)},d=function(){},o=function(){if($("#img-wrapper-tmpl").tmpl({itemsCount:t}).prependTo(i),t>1){var e=i.find("a.rg-image-nav-prev"),n=i.find("a.rg-image-nav-next"),r=i.find("div.rg-image");e.on("click.rgGallery",function(i){return s("left"),!1}),n.on("click.rgGallery",function(i){return s("right"),!1}),r.touchwipe({wipeLeft:function(){s("right")},wipeRight:function(){s("left")},preventDefaultEvents:!1}),$(document).on("keyup.rgGallery",function(i){39==i.keyCode?s("right"):37==i.keyCode&&s("left")})}},s=function(i){if(a)return!1;a=!0,"right"===i?r+1>=t?r=0:++r:"left"===i&&(r-1<0?r=t-1:--r),c(n.eq(r))},c=function(t){var l=i.find("div.rg-loading").show();n.removeClass("selected"),t.addClass("selected");var d=t.find("img"),o=d.data("large"),s=d.data("description");$("<img/>").load(function(){i.find("div.rg-image").empty().append('<img src="'+o+'"/>'),s&&i.find("div.rg-caption").show().children("p").empty().text(s),l.hide(),e.elastislide("reload"),e.elastislide("setCurrent",r),a=!1}).attr("src",o)};return{init:function(){n.add('<img src="images/ajax-loader.gif"/><img src="images/black.png"/>').imagesLoaded(function(){d(),o(),c(n.eq(r))}),l()},addItems:function(i){e.find("ul").append(i),n=n.add($(i)),t=n.length,e.elastislide("add",i)}}}(),Gallery.init()});